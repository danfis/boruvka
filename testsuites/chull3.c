#include <cu/cu.h>
#include <fermat/chull3.h>
#include <fermat/dbg.h>
#include "data.h"

TEST(testCHull)
{
    fer_chull3_t *h;
    fer_vec3_t v;

    h = ferCHull3New();


    ferVec3Set(&v, 0., 0., 0.);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 1., 0., 0.);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 1., 1., 0.);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0., 1., 0.);
    ferCHull3Add(h, &v);

    ferVec3Set(&v, 0., 0., 1.);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 1., 0., 1.);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 1., 1., 1.);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0., 1., 1.);
    ferCHull3Add(h, &v);
    ferCHull3DumpSVT(h, stdout, "1");


    ferVec3Set(&v, 0., 0., 0.);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 1., 0., 0.);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 1., 1., 0.);
    ferCHull3Add(h, &v);

    ferVec3Set(&v, 0.5, 0.5, 0.1);
    ferCHull3Add(h, &v);

    ferVec3Set(&v, 0., 1., 2.);
    ferCHull3Add(h, &v);

    ferVec3Set(&v, 0.5, 0.5, 0.1);
    ferCHull3Add(h, &v);

    ferVec3Set(&v, 1., 0., 1.);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 1., 1., 1.);
    ferCHull3Add(h, &v);

    ferCHull3DumpSVT(h, stdout, "2");

    ferCHull3Del(h);
}

TEST(testCHull2)
{

    fer_chull3_t *h;
    fer_vec3_t v;

    h = ferCHull3New();

    ferVec3Set(&v, 0.154361, 0.056943, 0.857042);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.143624, 0.032206, 0.885913);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.158999, 0.00149, 0.835374);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "3");

    ferVec3Set(&v, 0.16607, 0.035644, 0.818261);
    ferCHull3Add(h, &v);

    //ferCHull3DumpSVT(h, stdout, "3");

    ferVec3Set(&v, 0.154361, 0.056943, 0.857042);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.143624, 0.032206, 0.885913);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.158999, 0.00149, 0.835374);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "3");

    ferVec3Set(&v, 0.16607, 0.035644, 0.918261);
    ferCHull3Add(h, &v);

    ferCHull3DumpSVT(h, stdout, "3");
    ferCHull3Del(h);


    h = ferCHull3New();

    ferVec3Set(&v, -0.209063, -0.663393, 0.509344);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, -0.282599, -0.663393, 0.412411);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, -0.058384, -0.663401, 0.372891);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "4");

    ferVec3Set(&v, -0.127096, -0.663398, 0.479316);
    ferCHull3Add(h, &v);
    ferCHull3DumpSVT(h, stdout, "4");

    //ferVec3Set(&v, -0.209063, -0.663393, 0.509344);
    //ferVec3Set(&v, -0.282599, -0.663393, 0.412411);
    //ferVec3Set(&v, -0.058384, -0.663401, 0.372891);


    ferCHull3Del(h);

    h = ferCHull3New();
    ferVec3Set(&v, 0.286603, -0.232731, 0.027162);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.274526, -0.261706, 0.00511);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.290866, -0.277304, -0.061905);
    ferCHull3Add(h, &v);

    //ferCHull3DumpSVT(h, stdout, "5");
    ferVec3Set(&v, 0.259842, -0.283292, -0.003185);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "5");
    ferVec3Set(&v, 0.222861, -0.340431, -0.03821);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "5");
    ferVec3Set(&v, 0.259842, -0.283292, -0.003185);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "5");

    ferVec3Set(&v, 0.266526, -0.27365, 0.039597);
    ferCHull3Add(h, &v);
    ferCHull3DumpSVT(h, stdout, "5");

    ferCHull3Del(h);
}

TEST(testCHull3)
{
    fer_chull3_t *h;
    fer_vec3_t v;

    h = ferCHull3New();

    ferVec3Set(&v, 0.104725, 0.108156, -0.94913);
    ferCHull3Add(h, &v);

    ferVec3Set(&v, 0.118944, 0.012799, -0.880702);
    ferCHull3Add(h, &v);

    ferVec3Set(&v, 0.061944, 0.014564, -0.882086);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull3");

    ferVec3Set(&v, 0.185542, 0.011005, -0.879202);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull3");

    ferVec3Set(&v, 0.118944, 0.012799, -0.880702);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull3");

    ferVec3Set(&v, 0.104725, 0.108156, -0.94913);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull3");

    ferVec3Set(&v, 0.184061, 0.101854, -0.91822);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull3");

    ferVec3Set(&v, 0.185542, 0.011005, -0.879202);
    ferCHull3Add(h, &v);
    ferCHull3DumpSVT(h, stdout, "testCHull3");

    ferCHull3Del(h);
}

TEST(testCHull4)
{
    fer_chull3_t *h;
    fer_vec3_t v;

    h = ferCHull3New();

    ferVec3Set(&v, -0.272542, -0.665381, -0.592063);
    ferCHull3Add(h, &v);

    ferVec3Set(&v, -0.257884, -0.665381, -0.658052);
    ferCHull3Add(h, &v);

    ferVec3Set(&v, -0.183019, -0.665378, -0.71763);
    ferCHull3Add(h, &v);

    ferVec3Set(&v, -0.108152, -0.665375, -0.700408);
    ferCHull3Add(h, &v);

    ferVec3Set(&v, -0.108152, -0.665375, -0.700408);
    ferCHull3Add(h, &v);

    ferVec3Set(&v, -0.071683, -0.665372, -0.606385);
    ferCHull3Add(h, &v);

    ferVec3Set(&v, -0.257884, -0.665381, -0.658052);
    ferCHull3Add(h, &v);

    ferVec3Set(&v, -0.186168, -0.605282, -0.72469);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull4");

    ferVec3Set(&v, -0.183019, -0.665378, -0.71763);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull4");

    ferVec3Set(&v, -0.108152, -0.665375, -0.700408);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull4");

    ferVec3Set(&v, -0.186168, -0.605282, -0.72469);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull4");

    ferVec3Set(&v, -0.086439, -0.584866, -0.608343);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull4");

    ferVec3Set(&v, -0.071683, -0.665372, -0.606385);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull4");

    ferVec3Set(&v, -0.257884, -0.665381, -0.658052);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull4");

    ferVec3Set(&v, -0.267633, -0.603419, -0.655209);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull4");

    ferVec3Set(&v, -0.186168, -0.605282, -0.72469);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull4");

    ferVec3Set(&v, -0.168595, -0.529132, -0.654931);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull4");

    ferVec3Set(&v, -0.237395, -0.542544, -0.587188);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull4");

    ferVec3Set(&v, -0.272542, -0.665381, -0.592063);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull4");

    ferVec3Set(&v, -0.28229, -0.61814, -0.58922);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull4");

    ferVec3Set(&v, -0.168595, -0.529132, -0.654931);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull4");

    ferVec3Set(&v, -0.141182, -0.437705, -0.798194);
    ferCHull3Add(h, &v);
    ferCHull3DumpSVT(h, stdout, "testCHull4");

    ferCHull3Del(h);
}

TEST(testCHull5)
{
    fer_chull3_t *h;
    fer_vec3_t v;

    h = ferCHull3New();

    ferVec3Set(&v, 0.286603, -0.232731, 0.027162);
    ferCHull3Add(h, &v);

    ferVec3Set(&v, 0.274526, -0.261706, 0.00511);
    ferCHull3Add(h, &v);

    ferVec3Set(&v, 0.290866, -0.277304, -0.061905);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull5");

    ferVec3Set(&v, 0.259842, -0.283292, -0.003185);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull5");

    ferVec3Set(&v, 0.222861, -0.340431, -0.03821);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull5");

    ferVec3Set(&v, 0.266526, -0.27365, 0.039597);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull5");

    ferVec3Set(&v, 0.290866, -0.277304, -0.061905);
    ferCHull3Add(h, &v);
    ferCHull3DumpSVT(h, stdout, "testCHull5");

    ferCHull3Del(h);
}

TEST(testCHull6)
{
    fer_chull3_t *h;
    fer_vec3_t v;

    h = ferCHull3New();

    ferVec3Set(&v, 0, 0, 0);
    ferCHull3Add(h, &v);

    ferVec3Set(&v, 1, 0, 0);
    ferCHull3Add(h, &v);

    ferVec3Set(&v, 0, 1, 0);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull6");

    ferVec3Set(&v, -1, 0.5, 0);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull6");

    ferVec3Set(&v, -2, 1.5, 0);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull6");

    ferVec3Set(&v, 0.5, -5, 0);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull6");

    ferVec3Set(&v, 1, 1, 2);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull6");

    ferVec3Set(&v, -1, 1, 2);
    ferCHull3Add(h, &v);
    ferCHull3DumpSVT(h, stdout, "testCHull6");

    ferCHull3Del(h);
}

TEST(testCHull7)
{
    fer_chull3_t *h;
    fer_vec3_t v;

    h = ferCHull3New();

    ferVec3Set(&v, -0.25573, 0.090306, 0.670782);
    ferCHull3Add(h, &v);

    ferVec3Set(&v, -0.195072, 0.129179, 0.731104);
    ferCHull3Add(h, &v);

    ferVec3Set(&v, -0.255594, 0.113833, 0.663389);
    ferCHull3Add(h, &v);

    ferVec3Set(&v, -0.241515, 0.311485, 0.587832);
    ferCHull3Add(h, &v);

    ferVec3Set(&v, -0.22638, 0.212655, 0.61774);
    ferCHull3Add(h, &v);

    ferVec3Set(&v, -0.216677, 0.309274, 0.642272);
    ferCHull3Add(h, &v);

    ferVec3Set(&v, -0.241515, 0.311485, 0.587832);
    ferCHull3Add(h, &v);

    ferVec3Set(&v, -0.268594, 0.193403, 0.502766);
    ferCHull3Add(h, &v);
    //ferCHull3DumpSVT(h, stdout, "testCHull7");

    ferVec3Set(&v, -0.303961, 0.054199, 0.625921);
    ferCHull3Add(h, &v);
    ferCHull3DumpSVT(h, stdout, "testCHull7");

    /*
    ferVec3Set(&v, -0.277159, 0.126123, 0.443289);
    ferCHull3Add(h, &v);
    ferCHull3DumpSVT(h, stdout, "testCHull7");

    ferVec3Set(&v, -0.287605, -0.005722, 0.531844);
    ferCHull3Add(h, &v);
    ferCHull3DumpSVT(h, stdout, "testCHull7");

    ferVec3Set(&v, -0.268594, 0.193403, 0.502766);
    ferCHull3Add(h, &v);
    ferCHull3DumpSVT(h, stdout, "testCHull7");


    ferVec3Set(&v, -0.22638, 0.212655, 0.61774);
    ferCHull3Add(h, &v);
    ferCHull3DumpSVT(h, stdout, "testCHull7");
    */


    ferCHull3Del(h);
}

TEST(testCHull8)
{
    fer_chull3_t *h;
    fer_vec3_t v;

    h = ferCHull3New();

    ferVec3Set(&v, 0.279163002967834472656250000000, -0.664604008197784423828125000000, 0.417328000068664550781250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.259285986423492431640625000000, -0.664547026157379150390625000000, 0.471280992031097412109375000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.204445004463195800781250000000, -0.664380013942718505859375000000, 0.513352990150451660156250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.279163002967834472656250000000, -0.664604008197784423828125000000, 0.417328000068664550781250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.259285986423492431640625000000, -0.664547026157379150390625000000, 0.471280992031097412109375000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.204445004463195800781250000000, -0.664380013942718505859375000000, 0.513352990150451660156250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.279163002967834472656250000000, -0.664604008197784423828125000000, 0.417328000068664550781250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.259285986423492431640625000000, -0.664547026157379150390625000000, 0.471280992031097412109375000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.204445004463195800781250000000, -0.664380013942718505859375000000, 0.513352990150451660156250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.279163002967834472656250000000, -0.664604008197784423828125000000, 0.417328000068664550781250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.204445004463195800781250000000, -0.664380013942718505859375000000, 0.513352990150451660156250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.122854001820087432861328125000, -0.664138019084930419921875000000, 0.482322990894317626953125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.279163002967834472656250000000, -0.664604008197784423828125000000, 0.417328000068664550781250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.204445004463195800781250000000, -0.664380013942718505859375000000, 0.513352990150451660156250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.122854001820087432861328125000, -0.664138019084930419921875000000, 0.482322990894317626953125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.279163002967834472656250000000, -0.664604008197784423828125000000, 0.417328000068664550781250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.204445004463195800781250000000, -0.664380013942718505859375000000, 0.513352990150451660156250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.122854001820087432861328125000, -0.664138019084930419921875000000, 0.482322990894317626953125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.277157008647918701171875000000, -0.528122007846832275390625000000, 0.400207996368408203125000000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.185402005910873413085937500000, -0.476020008325576782226562500000, 0.421718001365661621093750000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.204445004463195800781250000000, -0.664380013942718505859375000000, 0.513352990150451660156250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.277157008647918701171875000000, -0.528122007846832275390625000000, 0.400207996368408203125000000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.185402005910873413085937500000, -0.476020008325576782226562500000, 0.421718001365661621093750000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.204445004463195800781250000000, -0.664380013942718505859375000000, 0.513352990150451660156250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.277157008647918701171875000000, -0.528122007846832275390625000000, 0.400207996368408203125000000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.185402005910873413085937500000, -0.476020008325576782226562500000, 0.421718001365661621093750000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.204445004463195800781250000000, -0.664380013942718505859375000000, 0.513352990150451660156250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.277157008647918701171875000000, -0.528122007846832275390625000000, 0.400207996368408203125000000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.204445004463195800781250000000, -0.664380013942718505859375000000, 0.513352990150451660156250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.259285986423492431640625000000, -0.664547026157379150390625000000, 0.471280992031097412109375000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.277157008647918701171875000000, -0.528122007846832275390625000000, 0.400207996368408203125000000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.204445004463195800781250000000, -0.664380013942718505859375000000, 0.513352990150451660156250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.259285986423492431640625000000, -0.664547026157379150390625000000, 0.471280992031097412109375000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.277157008647918701171875000000, -0.528122007846832275390625000000, 0.400207996368408203125000000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.204445004463195800781250000000, -0.664380013942718505859375000000, 0.513352990150451660156250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.259285986423492431640625000000, -0.664547026157379150390625000000, 0.471280992031097412109375000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.277157008647918701171875000000, -0.528122007846832275390625000000, 0.400207996368408203125000000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.183069005608558654785156250000, -0.509811997413635253906250000000, 0.329995006322860717773437500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.185402005910873413085937500000, -0.476020008325576782226562500000, 0.421718001365661621093750000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.277157008647918701171875000000, -0.528122007846832275390625000000, 0.400207996368408203125000000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.183069005608558654785156250000, -0.509811997413635253906250000000, 0.329995006322860717773437500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.185402005910873413085937500000, -0.476020008325576782226562500000, 0.421718001365661621093750000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.277157008647918701171875000000, -0.528122007846832275390625000000, 0.400207996368408203125000000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.183069005608558654785156250000, -0.509811997413635253906250000000, 0.329995006322860717773437500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.185402005910873413085937500000, -0.476020008325576782226562500000, 0.421718001365661621093750000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.046519998461008071899414062500, -0.531570971012115478515625000000, 0.391918003559112548828125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.204445004463195800781250000000, -0.664380013942718505859375000000, 0.513352990150451660156250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.185402005910873413085937500000, -0.476020008325576782226562500000, 0.421718001365661621093750000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.046519998461008071899414062500, -0.531570971012115478515625000000, 0.391918003559112548828125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.204445004463195800781250000000, -0.664380013942718505859375000000, 0.513352990150451660156250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.185402005910873413085937500000, -0.476020008325576782226562500000, 0.421718001365661621093750000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.046519998461008071899414062500, -0.531570971012115478515625000000, 0.391918003559112548828125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.204445004463195800781250000000, -0.664380013942718505859375000000, 0.513352990150451660156250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.185402005910873413085937500000, -0.476020008325576782226562500000, 0.421718001365661621093750000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.055449999868869781494140625000, -0.663935005664825439453125000000, 0.375064998865127563476562500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.053854998201131820678710937500, -0.663931012153625488281250000000, 0.328224003314971923828125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.254815995693206787109375000000, -0.664541006088256835937500000000, 0.290686994791030883789062500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.055449999868869781494140625000, -0.663935005664825439453125000000, 0.375064998865127563476562500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.053854998201131820678710937500, -0.663931012153625488281250000000, 0.328224003314971923828125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.254815995693206787109375000000, -0.664541006088256835937500000000, 0.290686994791030883789062500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.055449999868869781494140625000, -0.663935005664825439453125000000, 0.375064998865127563476562500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.053854998201131820678710937500, -0.663931012153625488281250000000, 0.328224003314971923828125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.254815995693206787109375000000, -0.664541006088256835937500000000, 0.290686994791030883789062500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.055449999868869781494140625000, -0.663935005664825439453125000000, 0.375064998865127563476562500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.254815995693206787109375000000, -0.664541006088256835937500000000, 0.290686994791030883789062500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.279163002967834472656250000000, -0.664604008197784423828125000000, 0.417328000068664550781250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.055449999868869781494140625000, -0.663935005664825439453125000000, 0.375064998865127563476562500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.254815995693206787109375000000, -0.664541006088256835937500000000, 0.290686994791030883789062500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.279163002967834472656250000000, -0.664604008197784423828125000000, 0.417328000068664550781250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.055449999868869781494140625000, -0.663935005664825439453125000000, 0.375064998865127563476562500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.254815995693206787109375000000, -0.664541006088256835937500000000, 0.290686994791030883789062500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.279163002967834472656250000000, -0.664604008197784423828125000000, 0.417328000068664550781250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.279163002967834472656250000000, -0.664604008197784423828125000000, 0.417328000068664550781250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.122854001820087432861328125000, -0.664138019084930419921875000000, 0.482322990894317626953125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.055449999868869781494140625000, -0.663935005664825439453125000000, 0.375064998865127563476562500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.279163002967834472656250000000, -0.664604008197784423828125000000, 0.417328000068664550781250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.122854001820087432861328125000, -0.664138019084930419921875000000, 0.482322990894317626953125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.055449999868869781494140625000, -0.663935005664825439453125000000, 0.375064998865127563476562500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.279163002967834472656250000000, -0.664604008197784423828125000000, 0.417328000068664550781250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.122854001820087432861328125000, -0.664138019084930419921875000000, 0.482322990894317626953125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.055449999868869781494140625000, -0.663935005664825439453125000000, 0.375064998865127563476562500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.046519998461008071899414062500, -0.531570971012115478515625000000, 0.391918003559112548828125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.122854001820087432861328125000, -0.664138019084930419921875000000, 0.482322990894317626953125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.204445004463195800781250000000, -0.664380013942718505859375000000, 0.513352990150451660156250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.046519998461008071899414062500, -0.531570971012115478515625000000, 0.391918003559112548828125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.122854001820087432861328125000, -0.664138019084930419921875000000, 0.482322990894317626953125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.204445004463195800781250000000, -0.664380013942718505859375000000, 0.513352990150451660156250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.046519998461008071899414062500, -0.531570971012115478515625000000, 0.391918003559112548828125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.122854001820087432861328125000, -0.664138019084930419921875000000, 0.482322990894317626953125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.204445004463195800781250000000, -0.664380013942718505859375000000, 0.513352990150451660156250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.046519998461008071899414062500, -0.531570971012115478515625000000, 0.391918003559112548828125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.053854998201131820678710937500, -0.663931012153625488281250000000, 0.328224003314971923828125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.055449999868869781494140625000, -0.663935005664825439453125000000, 0.375064998865127563476562500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.046519998461008071899414062500, -0.531570971012115478515625000000, 0.391918003559112548828125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.053854998201131820678710937500, -0.663931012153625488281250000000, 0.328224003314971923828125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.055449999868869781494140625000, -0.663935005664825439453125000000, 0.375064998865127563476562500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.046519998461008071899414062500, -0.531570971012115478515625000000, 0.391918003559112548828125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.053854998201131820678710937500, -0.663931012153625488281250000000, 0.328224003314971923828125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.055449999868869781494140625000, -0.663935005664825439453125000000, 0.375064998865127563476562500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.122854001820087432861328125000, -0.664138019084930419921875000000, 0.482322990894317626953125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.046519998461008071899414062500, -0.531570971012115478515625000000, 0.391918003559112548828125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.055449999868869781494140625000, -0.663935005664825439453125000000, 0.375064998865127563476562500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.122854001820087432861328125000, -0.664138019084930419921875000000, 0.482322990894317626953125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.046519998461008071899414062500, -0.531570971012115478515625000000, 0.391918003559112548828125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.055449999868869781494140625000, -0.663935005664825439453125000000, 0.375064998865127563476562500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.122854001820087432861328125000, -0.664138019084930419921875000000, 0.482322990894317626953125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.046519998461008071899414062500, -0.531570971012115478515625000000, 0.391918003559112548828125000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.055449999868869781494140625000, -0.663935005664825439453125000000, 0.375064998865127563476562500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.277157008647918701171875000000, -0.528122007846832275390625000000, 0.400207996368408203125000000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.271436005830764770507812500000, -0.567707002162933349609375000000, 0.263965994119644165039062500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.183069005608558654785156250000, -0.509811997413635253906250000000, 0.329995006322860717773437500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.277157008647918701171875000000, -0.528122007846832275390625000000, 0.400207996368408203125000000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.271436005830764770507812500000, -0.567707002162933349609375000000, 0.263965994119644165039062500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.183069005608558654785156250000, -0.509811997413635253906250000000, 0.329995006322860717773437500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.277157008647918701171875000000, -0.528122007846832275390625000000, 0.400207996368408203125000000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.271436005830764770507812500000, -0.567707002162933349609375000000, 0.263965994119644165039062500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.183069005608558654785156250000, -0.509811997413635253906250000000, 0.329995006322860717773437500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.227520003914833068847656250000, -0.373261988162994384765625000000, 0.293101996183395385742187500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.183069005608558654785156250000, -0.509811997413635253906250000000, 0.329995006322860717773437500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.271436005830764770507812500000, -0.567707002162933349609375000000, 0.263965994119644165039062500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.227520003914833068847656250000, -0.373261988162994384765625000000, 0.293101996183395385742187500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.183069005608558654785156250000, -0.509811997413635253906250000000, 0.329995006322860717773437500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.271436005830764770507812500000, -0.567707002162933349609375000000, 0.263965994119644165039062500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.227520003914833068847656250000, -0.373261988162994384765625000000, 0.293101996183395385742187500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.183069005608558654785156250000, -0.509811997413635253906250000000, 0.329995006322860717773437500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.271436005830764770507812500000, -0.567707002162933349609375000000, 0.263965994119644165039062500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.259285986423492431640625000000, -0.664547026157379150390625000000, 0.471280992031097412109375000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.279163002967834472656250000000, -0.664604008197784423828125000000, 0.417328000068664550781250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.277157008647918701171875000000, -0.528122007846832275390625000000, 0.400207996368408203125000000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.259285986423492431640625000000, -0.664547026157379150390625000000, 0.471280992031097412109375000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.279163002967834472656250000000, -0.664604008197784423828125000000, 0.417328000068664550781250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.277157008647918701171875000000, -0.528122007846832275390625000000, 0.400207996368408203125000000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.259285986423492431640625000000, -0.664547026157379150390625000000, 0.471280992031097412109375000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.279163002967834472656250000000, -0.664604008197784423828125000000, 0.417328000068664550781250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.277157008647918701171875000000, -0.528122007846832275390625000000, 0.400207996368408203125000000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.277157008647918701171875000000, -0.528122007846832275390625000000, 0.400207996368408203125000000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.279163002967834472656250000000, -0.664604008197784423828125000000, 0.417328000068664550781250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.254815995693206787109375000000, -0.664541006088256835937500000000, 0.290686994791030883789062500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.277157008647918701171875000000, -0.528122007846832275390625000000, 0.400207996368408203125000000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.279163002967834472656250000000, -0.664604008197784423828125000000, 0.417328000068664550781250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.254815995693206787109375000000, -0.664541006088256835937500000000, 0.290686994791030883789062500000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.277157008647918701171875000000, -0.528122007846832275390625000000, 0.400207996368408203125000000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.279163002967834472656250000000, -0.664604008197784423828125000000, 0.417328000068664550781250000000);
    ferCHull3Add(h, &v);
    ferVec3Set(&v, 0.254815995693206787109375000000, -0.664541006088256835937500000000, 0.290686994791030883789062500000);
    ferCHull3Add(h, &v);
    ferCHull3DumpSVT(h, stdout, "testCHull8");


    ferCHull3Del(h);
}




TEST(testCHullBunny)
{
    fer_chull3_t *h;
    size_t i;

    h = ferCHull3New();

    for (i = 0; i < bunny_coords_len; i++){
        ferCHull3Add(h, &bunny_coords[i]);
    }

    testBunnyDumpSVT(stdout, "bunny object");
    ferCHull3DumpSVT(h, stdout, "bunny");
    ferCHull3Del(h);
}
